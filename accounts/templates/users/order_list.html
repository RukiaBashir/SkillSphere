{% extends "user_base.html" %}
{% load humanize %}  {# Enable number formatting #}

{% block content %}
<div class="container">
    <h1>Completed Orders</h1>
    <table class="table">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Total (KES)</th>
                <th>Status</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td>{{ order.id }}</td>
                <td>KES {{ order.total|floatformat:2|intcomma }}</td>
                <td>{{ order.order_status|default:"N/A" }}</td>
                <td>{{ order.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">No completed orders found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h1>Pending Cart Items</h1>
    <table class="table">
        <thead>
            <tr>
                <th>Item</th>
                <th>Amount (KES)</th>
                <th>Date Added</th>
            </tr>
        </thead>
        <tbody>
            {% for item in pending_cart_items %}
            <tr>
                <td>
                    {% if item.class_booking %}
                        {{ item.class_booking.title }}
                    {% else %}
                        Registration Fee
                    {% endif %}
                </td>
                <td>KES {{ item.amount|floatformat:2|intcomma }}</td>
                <td>{{ item.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3">No pending cart items.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{% url 'accounts:dashboard' %}" class="btn btn-secondary mt-3">Back to Dashboard</a>
</div>
{% endblock %}
